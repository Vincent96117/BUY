<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>V178-X SQUEEZE COMMANDER V1.1</title>
    <style>
        :root { --bg: #0b0e11; --card: #181a20; --ready: #f0b90b; --entry: #f6465d; --hold: #2ebd85; --scan: #474d57; --text: #eaecef; }
        body { background: var(--bg); color: var(--text); font-family: "PingFang TC", sans-serif; margin: 0; padding: 10px; }
        .container { max-width: 800px; margin: 0 auto; }
        .header { background: var(--card); padding: 15px; border-radius: 10px; margin-bottom: 15px; border: 1px solid #333; text-align: center; }
        
        table { width: 100%; border-collapse: collapse; background: var(--card); border-radius: 10px; overflow: hidden; }
        th { background: #1e2329; color: #848e9c; padding: 12px 8px; font-size: 12px; text-align: left; }
        td { padding: 12px 8px; border-bottom: 1px solid #2b2f36; }
        
        .symbol-name { font-size: 16px; font-weight: bold; color: #fff; }
        .status-badge { padding: 4px 10px; border-radius: 4px; font-weight: bold; font-size: 12px; display: inline-block; position: relative; }
        
        /* ç‡ˆè™Ÿæ¨£å¼ */
        .SCAN { background: rgba(71, 77, 87, 0.15); color: var(--scan); border: 1px solid var(--scan); }
        .READY { background: rgba(240, 185, 11, 0.15); color: var(--ready); border: 1px solid var(--ready); box-shadow: 0 0 8px rgba(240, 185, 11, 0.3); }
        .ENTRY { background: rgba(246, 70, 93, 0.2); color: var(--entry); border: 1px solid var(--entry); box-shadow: 0 0 10px var(--entry); animation: pulse 1s infinite; }
        
        .price-info { font-family: 'Roboto Mono', monospace; }
        .fund-val { font-size: 13px; font-weight: bold; }
        .fund-warn { color: #00ffff; text-shadow: 0 0 5px #00ffff; }
        
        @keyframes pulse { 0% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.05); opacity: 0.7; } 100% { transform: scale(1); opacity: 1; } }
        .progress-bg { height: 4px; background: #333; margin-top: 8px; border-radius: 2px; }
        .progress-bar { height: 100%; background: var(--ready); border-radius: 2px; transition: width 0.3s; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <div style="color: var(--ready); font-size: 20px; font-weight: bold; letter-spacing: 1px;">V178-X å˜ç©ºæŒ‡æ®å®˜ <span style="font-size:12px; color:#666">V1.1</span></div>
        <div id="market-summary" style="font-size: 12px; color: #848e9c; margin-top: 5px;">å¸‚å ´æƒæä¸­...</div>
    </div>

    <table>
        <thead>
            <tr>
                <th>åˆç´„å¹£ç¨®</th>
                <th>è§€å¯Ÿåƒ¹/ç•¶å‰</th>
                <th>ç‡ˆè™ŸæŒ‡ä»¤</th>
                <th>è³‡è²»</th>
                <th>å¼•åŠ›è·é›¢</th>
            </tr>
        </thead>
        <tbody id="list"></tbody>
    </table>
</div>

<script>
    // æ’é™¤å¸‚å€¼å‰ 25 å + ä½ ä¸æƒ³è¦çš„ BTC, ETH, SOL, XRP, BNB, BNX
    const blacklist = ["BTCUSDT", "ETHUSDT", "SOLUSDT", "XRPUSDT", "BNBUSDT", "BNXUSDT", "DOGEUSDT", "ADAUSDT", "TRXUSDT", "AVAXUSDT", "DOTUSDT", "SHIBUSDT", "TONUSDT", "LINKUSDT", "BCHUSDT", "NEARUSDT", "MATICUSDT", "LTCUSDT", "PEPEUSDT", "UNIUSDT", "ICPUSDT", "RENDERUSDT", "APTUSDT", "HBARUSDT", "ARBUSDT", "SUIUSDT"];

    async function get7DHigh(symbol) {
        try {
            const r = await fetch(`https://fapi.binance.com/fapi/v1/klines?symbol=${symbol}&interval=4h&limit=42`);
            const d = await r.json();
            return Math.max(...d.map(k => parseFloat(k[2])));
        } catch(e) { return 0; }
    }

    async function update() {
        try {
            const tickerR = await fetch('https://fapi.binance.com/fapi/v1/ticker/24hr');
            const all = await tickerR.json();
            
            // 1. ç¯©é¸ USDT çµå°¾ 2. æ’é™¤é»‘åå–® 3. ç¢ºä¿æœ‰æˆäº¤é‡
            const candidates = all.filter(c => c.symbol.endsWith('USDT') && !blacklist.includes(c.symbol) && parseFloat(c.quoteVolume) > 30000000)
                              .sort((a,b) => b.quoteVolume - a.quoteVolume).slice(0, 20);

            const listBody = document.getElementById('list');
            listBody.innerHTML = '';
            document.getElementById('market-summary').innerText = `æœ€å¾Œæ›´æ–°: ${new Date().toLocaleTimeString()} (USDT åˆç´„å°ˆç”¨)`;

            for (let coin of candidates) {
                const high7D = await get7DHigh(coin.symbol);
                const curPrice = parseFloat(coin.lastPrice);
                
                const fundR = await fetch(`https://fapi.binance.com/fapi/v1/premiumIndex?symbol=${coin.symbol}`);
                const fundD = await fundR.json();
                const fund = (parseFloat(fundD.lastFundingRate) * 100).toFixed(4);
                
                const dist = ((high7D - curPrice) / curPrice * 100).toFixed(2);
                
                // ç‹€æ…‹ç‡ˆè™Ÿåˆ¤å®š
                let st = { cmd: "SCAN", cls: "SCAN", note: "å°‹æ‰¾ç‡ƒæ–™" };
                
                if (curPrice >= high7D * 1.002 && fund < -0.05) {
                    st = { cmd: "ENTRY", cls: "ENTRY", note: "ğŸ”´ çªç ´é»ç«" };
                } else if (dist < 1.5 && dist > 0 && fund < -0.07) {
                    st = { cmd: "READY", cls: "READY", note: "ğŸŸ¡ çµæ§‹é‚Šç·£" };
                }

                const row = `
                    <tr>
                        <td>
                            <div class="symbol-name">${coin.symbol.replace('USDT','')}</div>
                            <div style="font-size:10px; color:#5e6673">7D High: ${high7D}</div>
                        </td>
                        <td class="price-info">
                            <div style="font-size:15px; color:#fff">${curPrice}</div>
                        </td>
                        <td>
                            <span class="status-badge ${st.cls}">${st.cmd}</span>
                            <div style="font-size:10px; color:#848e9c; margin-top:4px">${st.note}</div>
                        </td>
                        <td class="fund-val ${Math.abs(fund)>=0.05?'fund-warn':''}">${fund}%</td>
                        <td style="width: 100px;">
                            <div style="font-size:12px; text-align:right; color:${dist < 1.5 ? 'var(--ready)' : '#888'}">${dist}%</div>
                            <div class="progress-bg"><div class="progress-bar" style="width:${Math.max(0, 100-(dist*40))}%; background:${dist < 1.5 ? 'var(--ready)' : '#333'}"></div></div>
                        </td>
                    </tr>
                `;
                listBody.insertAdjacentHTML('beforeend', row);
            }
        } catch (e) {}
    }

    setInterval(update, 30000); 
    update();
</script>
</body>
</html>
